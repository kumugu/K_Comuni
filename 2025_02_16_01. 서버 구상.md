

1. **도메인별 마이크로서비스 분리** (`Player Service`, `World Service`, `Combat Service` 등)
2. **각 서비스별 독립된 DB + Redis 배포**
3. **데이터베이스 Master-Slave 복제 적용** (PostgreSQL, MySQL, MongoDB 조합)
4. **Redis를 캐싱 계층으로 활용하여 부하 최소화**
5. **서비스 간 통신은 gRPC, Kafka 등을 활용하여 최적화**
6. **컨테이너 기반 배포 (Docker + Kubernetes)** 적용



```typ
// src/application/use-cases/GetPlayerInfo.ts
import { PlayerRepository } from '../ports/PlayerRepository';

export class GetPlayerInfo {
  constructor(private readonly playerRepository: PlayerRepository) {}

  async execute(playerId: string) {
    return this.playerRepository.findById(playerId);
  }
}

// src/infrastructure/adapters/PlayerRepositoryImpl.ts
import { Repository } from 'typeorm';
import { Player } from '../entities/Player';
import { PlayerRepository } from '../../application/ports/PlayerRepository';

export class PlayerRepositoryImpl implements PlayerRepository {
  constructor(private readonly ormRepo: Repository<Player>) {}

  async findById(playerId: string): Promise<Player | null> {
    return await this.ormRepo.findOne({ where: { id: playerId } });
  }
}


// src/infrastructure/controllers/PlayerController.ts
import { GetPlayerInfo } from '../../application/use-cases/GetPlayerInfo';

export class PlayerController {
  constructor(private readonly getPlayerInfo: GetPlayerInfo) {}

  async getPlayer(req, res) {
    const player = await this.getPlayerInfo.execute(req.params.id);
    res.json(player);
  }
}


import { RedisClientType, createClient } from 'redis';

class RedisCache {
  private client: RedisClientType;

  constructor() {
    this.client = createClient({
      url: process.env.REDIS_URL,
    });
    this.client.connect();
  }

  async get(key: string) {
    return await this.client.get(key);
  }

  async set(key: string, value: string, ttl: number = 3600) {
    await this.client.set(key, value, { EX: ttl });
  }
}
// PlayerService에서 Redis 적용
class PlayerService {
  constructor(private readonly playerRepository: PlayerRepository, private readonly cache: RedisCache) {}

  async getPlayer(playerId: string) {
    const cacheKey = `player:${playerId}`;
    let player = await this.cache.get(cacheKey);
    
    if (!player) {
      player = await this.playerRepository.findById(playerId);
      await this.cache.set(cacheKey, JSON.stringify(player), 3600);
    }

    return JSON.parse(player);
  }
}
```



```yaml
version: "3.8"
services:
  player-service:
    image: player-service:latest
    ports:
      - "3001:3001"
    environment:
      - DATABASE_URL=postgres://user:pass@player-db:5432/playerdb
      - REDIS_URL=redis://cache:6379

  player-db:
    image: postgres:14
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: pass
      POSTGRES_DB: playerdb
    volumes:
      - player_data:/var/lib/postgresql/data

  cache:
    image: redis:latest
    ports:
      - "6379:6379"

volumes:
  player_data:
```

